<script lang="ts">
  import Icon from './Icon.svelte';
  import type { iconType } from './Icon.svelte';
  import { page } from '$app/stores';
  import { twMerge } from 'tailwind-merge';
  import logo from '$lib/assets/logo_nav.png';
  import { tooltip } from '$lib/actions/tooltip';
  import { typedRoute } from '$lib/types/appRoutes';

  $: navItems = [
    {
      name: 'Overview',
      icon: 'home',
      href: typedRoute('/dashboard/overview'),
      active: $page.url.pathname.includes(typedRoute('/dashboard/overview'))
    },
    {
      name: 'Streams',
      icon: 'stream',
      href: typedRoute('/dashboard/streams'),
      active: $page.url.pathname.includes(typedRoute('/dashboard/streams'))
    },
    {
      name: 'Clients',
      icon: 'clients',
      href: typedRoute('/dashboard/clients'),
      active: $page.url.pathname.includes(typedRoute('/dashboard/clients'))
    },
    {
      name: 'Logs',
      icon: 'logs',
      href: typedRoute('/dashboard/logs'),
      active: $page.url.pathname.includes(typedRoute('/dashboard/logs'))
    },
    {
      name: 'Settings',
      icon: 'settings',
      href: typedRoute('/dashboard/settings/webUI'),
      active: $page.url.pathname.includes('/dashboard/settings')
    }
  ] satisfies { name: string; icon: iconType; href: string; active: boolean }[];
</script>

<nav
  class="fixed z-10 left-0 top-0 bottom-0 min-w-[90px] max-w-[90px] pb-7 pt-4 border-r flex flex-col items-center bg-shadeL300 dark:bg-shadeD1000"
>
  <a href={typedRoute('/dashboard/overview')} class="flex flex-col items-center gap-5 mb-5">
    <svg
      id="Warstwa_2"
      data-name="Warstwa 2"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 1976.32 645.02"
      class="w-[51px] h-[28px] pointer-events-none"
    >
      <g id="Warstwa_1-2" data-name="Warstwa 1">
        <g>
          <path class="fill-current text-black dark:text-white" d="M0,632.12V12.9h116.96v619.22H0Z" />
          <path
            class="fill-current text-black dark:text-white"
            d="M503.96,645.02c-38.99,0-76.11-6.95-111.37-20.86-35.26-13.9-66.44-34.47-93.53-61.71-27.09-27.23-48.45-60.91-64.07-101.05-15.63-40.13-23.44-86.43-23.44-138.89,0-68.51,13.12-126.78,39.35-174.8,26.23-48.01,61.49-84.64,105.78-109.87C400.98,12.62,450.07,0,503.96,0c79.69,0,142.33,18.49,187.91,55.47,45.58,36.98,76.11,89.3,91.59,156.95l-119.54,17.2c-11.18-36.12-29.46-65-54.83-86.65-25.37-21.64-57.84-32.61-97.4-32.9-39.28-.57-71.96,7.89-98.04,25.37-26.09,17.49-45.66,42.29-58.7,74.39-13.05,32.11-19.57,69.66-19.57,112.66s6.52,80.27,19.57,111.8c13.04,31.54,32.61,56.05,58.7,73.53,26.08,17.49,58.76,26.52,98.04,27.09,26.66.58,50.81-4.01,72.46-13.76,21.64-9.74,39.92-25.08,54.83-46.01,14.9-20.92,25.51-47.73,31.82-80.41h-98.04v-90.3h222.75c.57,3.73,1,10.32,1.29,19.78.28,9.46.43,14.91.43,16.34,0,59.34-12.04,111.95-36.12,157.81-24.08,45.87-58.05,81.78-101.91,107.72-43.86,25.95-95.61,38.92-155.23,38.92Z"
          />
          <path
            class="fill-current text-black dark:text-white"
            d="M1141.24,645.02c-38.99,0-76.11-6.95-111.37-20.86-35.26-13.9-66.44-34.47-93.53-61.71-27.09-27.23-48.45-60.91-64.07-101.05-15.63-40.13-23.44-86.43-23.44-138.89,0-68.51,13.12-126.78,39.35-174.8,26.23-48.01,61.49-84.64,105.78-109.87C1038.25,12.62,1087.34,0,1141.24,0c79.69,0,142.33,18.49,187.91,55.47,45.58,36.98,76.11,89.3,91.59,156.95l-119.54,17.2c-11.18-36.12-29.46-65-54.83-86.65-25.37-21.64-57.84-32.61-97.4-32.9-39.28-.57-71.96,7.89-98.04,25.37-26.09,17.49-45.66,42.29-58.7,74.39-13.05,32.11-19.57,69.66-19.57,112.66s6.52,80.27,19.57,111.8c13.04,31.54,32.61,56.05,58.7,73.53,26.08,17.49,58.76,26.52,98.04,27.09,26.66.58,50.81-4.01,72.46-13.76,21.64-9.74,39.92-25.08,54.83-46.01,14.9-20.92,25.51-47.73,31.82-80.41h-98.04v-90.3h222.75c.57,3.73,1,10.32,1.29,19.78.28,9.46.43,14.91.43,16.34,0,59.34-12.04,111.95-36.12,157.81-24.08,45.87-58.05,81.78-101.91,107.72-43.86,25.95-95.61,38.92-155.23,38.92Z"
          />
          <path
            class="fill-current text-black dark:text-white"
            d="M1646.07,632.12v-251.99L1434.5,12.9h136.74l134.16,233.07L1839.58,12.9h136.74l-211.57,367.23v251.99h-118.68Z"
          />
        </g>
      </g>
    </svg>
    <div class="w-[50px] h-[45px]">
      <img src={logo} class="w-[50px]" alt="iggy" />
    </div>
  </a>

  <ul class="flex flex-col gap-7">
    {#each navItems as { name, icon, href, active }}
      <li>
        <div use:tooltip={{ placement: 'right' }}>
          <a
            {href}
            data-trigger
            class={twMerge(
              'p-2 block rounded-xl transition-colors  ring-2 ring-transparent',
              active && 'ring-black dark:ring-white',
              !active && 'hover:bg-shadeL500 dark:hover:bg-shadeD300'
            )}
          >
            <Icon name={icon} class="w-[27px] h-[27px] text-black dark:text-white" />
          </a>
          <div class="tooltip">
            {name}
          </div>
        </div>
      </li>
    {/each}
  </ul>
</nav>
